@model MovieDetailVM


@{
	ViewData["Title"] = "Movie Details";
}




<input asp-for="Movie.MovieID" hidden />
<div class="container">
	<!-- Section 1: Movie Information -->
	<section id="movie-info" class="row mb-5">

		<div class="col-md-4">
			<img src="@Model.Movie.MovieImage" alt="Movie Poster" class="img-fluid" />
		</div>
		<div class="col-md-8">
			<h1>@Model.Movie.Title</h1>
			<!--<p><strong>Director:</strong> Director Name</p> -->
			<!--<p><strong>Cast:</strong> Actor 1, Actor 2, Actor 3</p> -->
			<p><strong>Genre:</strong>  @Model.Movie.Genre</p>
			<p><strong>Duration:</strong>  @Model.Movie.Duration</p>
			<p><strong>Release Date:</strong>  @Model.Movie.ReleaseDate</p>
			<p>
				<strong>Synopsis:</strong> @Model.Movie.Synopsis
			</p>
			<p>
				<a href="@Model.Movie.TrailerLink"><i class="fa-solid fa-circle-play" style="color: white;"></i></a> Watch Trailer
			</p>

		</div>
	</section>




<input type="hidden" id="movieID" value="@ViewData["MovieID"]" />


	<div class="container mt-3 mb-4">
		<div class="row mb-3">
			<div class="text-center fw-bold"><h3>Lịch Chiếu</h3></div>
			
			<div id="filterDates" class="col-12 d-flex justify-content-evenly flex-wrap mb-2"></div>

			<div class="d-flex justify-content-between align-items-center mb-2">
				<div class="fw-bold"><h3>Danh sách Rạp</h3></div>
				<div id="filterCities" class="small"></div>
			</div>

			<div id="movieDetails" class="col-8 mb-2 mx-auto"></div>
			<h3 class="category-title text-center fw-bold">Chọn loại vé</h3>
			<div id="ticketContainer" class="row justify-content-center">
				<!-- Ticket types will be inserted dynamically here -->
			</div>

			</div>

		</div>
	<div id="seatsContainer" class="mb-4 mx-auto col-8"></div>










    <!-- Section 4: Food Selection -->
    <section id="food-selection" class="mb-5">
        <h2 class="text-center">Food</h2>
        <h3 class="category-title text-center">Combo Food</h3>
        <div class="row justify-content-center" id="foodContainer">
          
          
        </div>
    </section>

   
        <div class="row align-items-center">
            <!-- Movie Details -->
            <div class="col-md-3">
                <p><strong>Movie:</strong> <span id="displayMovieName">@Model.Movie.Title</span></p>
            </div>

            <!-- Combined Food and Tickets Display -->
            <div class="col-md-3">
                <p><strong>Items:</strong> <span id="displayFood">None</span></p>
            </div>

            <!-- Countdown Timer -->
            <div class="col-md-3">
                <p><strong>Time expired:</strong> <span id="countdown">05:00</span></p>
            </div>

            <!-- Total Price -->
            <div class="col-md-2">
                <p><strong>Total:</strong> <span id="displayTotalPrice">0 VND</span></p>
            </div>

            <!-- Confirm Booking Button -->
            <div class="col-md-1">
                <button type="submit" class="btn btn-success">Confirm Booking</button>
            </div>
        </div>



   <form method="post" class="mb-5 ">
    <input type="hidden" name="MovieId" id="movieID" />
    <input type="hidden" name="MovieName" id="MovieName" />
    <input type="hidden" name="Date" id="selectedDate" />
    <input type="hidden" name="City" id="selectedCity" />
    <input type="hidden" name="Cinema" id="selectedCinema" />
    <input type="hidden" name="RoomId" id="RoomId" />
    <input type="hidden" name="RoomName" id="RoomName" />
    <input type="hidden" name="Showtime" id="selectedShowtime" />
    <input type="hidden" name="TotalPrice" id="TotalPrice" />

    <!-- Serialize JSON data before submission -->
    <input type="hidden" name="TicketsJson" id="TicketsJson" />
    <input type="hidden" name="SelectedSeatsJson" id="SelectedSeatsJson" />
    <input type="hidden" name="ItemsJson" id="ItemsJson" />

    <button type="submit" asp-controller="Detail" asp-action="ConfirmBooking" class="btn btn-success">Confirm Booking</button>
</form>


   



	


@section Scripts {
	<script src="~/js/detail.js"></script>
	<link rel="stylesheet" href="~/css/detail.css" />
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Example of setting JSON values dynamically
                document.getElementById("TicketsJson").value = JSON.stringify(selectedTickets);
                document.getElementById("SelectedSeatsJson").value = JSON.stringify(selectedSeats);
                document.getElementById("ItemsJson").value = JSON.stringify(selectedFoodItems);
            });
            document.getElementById("booking-summary")?.classList.remove("d-none");
                    <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Example: Setting values when the user selects options
                document.getElementById("MovieName").value = "Inception";
                document.getElementById("selectedDate").value = "2025-03-15";
                document.getElementById("selectedCity").value = "Tokyo";
                document.getElementById("selectedCinema").value = "Shibuya IMAX";
                document.getElementById("RoomId").value = "101";
                document.getElementById("RoomName").value = "VIP Room";
                document.getElementById("selectedShowtime").value = "18:00";
                document.getElementById("TotalPrice").value = "3500";

                // Example: Storing ticket selections in JSON
                let selectedTickets = [
                    { "Category": "Standard", "Quantity": 2 },
                    { "Category": "VIP", "Quantity": 1 }
                ];
                document.getElementById("TicketsJson").value = JSON.stringify(selectedTickets);

                // Example: Storing seat selections in JSON
                let selectedSeats = [
                    { "SeatNumber": "A1" },
                    { "SeatNumber": "A2" }
                ];
                document.getElementById("SelectedSeatsJson").value = JSON.stringify(selectedSeats);

                // Example: Storing food selections in JSON
                let selectedFood = [
                    { "Item": "Popcorn", "Quantity": 1 },
                    { "Item": "Soda", "Quantity": 1 }
                ];
                document.getElementById("ItemsJson").value = JSON.stringify(selectedFood);
            });

            // Ensure values are set before submitting
            document.getElementById("bookingForm").addEventListener("submit", function () {
                console.log("Submitting form with:");
                console.log("Movie Name:", document.getElementById("MovieName").value);
                console.log("Tickets:", document.getElementById("TicketsJson").value);
                console.log("Seats:", document.getElementById("SelectedSeatsJson").value);
                console.log("Food:", document.getElementById("ItemsJson").value);
            });
        </script>

        </script>
}




